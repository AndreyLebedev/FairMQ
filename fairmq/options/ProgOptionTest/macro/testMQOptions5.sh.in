#!/bin/bash

RUN_TEST="runtestMQOption1"

if [ "$#" -gt 0 ]; then
  RUN_TEST+=" $*"
fi

JSON_CMD_LINE="{"
JSON_CMD_LINE+="  \"fairMQOptions\": {"
JSON_CMD_LINE+="    \"device\": "
JSON_CMD_LINE+="      {"
JSON_CMD_LINE+="        \"name\": \"merger\","
JSON_CMD_LINE+="        \"id\": \"1234\","
JSON_CMD_LINE+="        \"channel\": "
JSON_CMD_LINE+="          {"
JSON_CMD_LINE+="            \"name\": \"two_inputs_channel\","
JSON_CMD_LINE+="            \"socket\": "
JSON_CMD_LINE+="              {"
JSON_CMD_LINE+="                \"name\": \"input1\","
JSON_CMD_LINE+="                \"type\": \"pull\","
JSON_CMD_LINE+="                \"method\": \"bind\","
JSON_CMD_LINE+="                \"address\": \"tcp://*:5569\","
JSON_CMD_LINE+="                \"sndBufSize\": \"1000\","
JSON_CMD_LINE+="                \"rcvBufSize\": \"1000\","
JSON_CMD_LINE+="                \"rateLogging\": \"1\" "
JSON_CMD_LINE+="              },"
JSON_CMD_LINE+="              \"socket\": "
JSON_CMD_LINE+="              {"
JSON_CMD_LINE+="                \"name\": \"input2\","
JSON_CMD_LINE+="                \"type\": \"pull\","
JSON_CMD_LINE+="                \"method\": \"bind\","
JSON_CMD_LINE+="                \"address\": \"tcp://*:5570\","
JSON_CMD_LINE+="                \"sndBufSize\": \"1000\","
JSON_CMD_LINE+="                \"rcvBufSize\": \"1000\","
JSON_CMD_LINE+="                \"rateLogging\": \"1\" "
JSON_CMD_LINE+="              }"            
JSON_CMD_LINE+="          },"
JSON_CMD_LINE+="          \"channel\":"
JSON_CMD_LINE+="          {"
JSON_CMD_LINE+="            \"name\": \"one_output_channel\","
JSON_CMD_LINE+="            \"socket\": {"
JSON_CMD_LINE+="              \"name\": \"output1\","
JSON_CMD_LINE+="              \"type\": \"push\","
JSON_CMD_LINE+="              \"method\": \"connect\","
JSON_CMD_LINE+="              \"address\": \"tcp://*:5571\","
JSON_CMD_LINE+="              \"sndBufSize\": \"1000\","
JSON_CMD_LINE+="              \"rcvBufSize\": \"1000\","
JSON_CMD_LINE+="              \"rateLogging\": \"1\" "
JSON_CMD_LINE+="            }"
JSON_CMD_LINE+="          }"        
JSON_CMD_LINE+="      },"
JSON_CMD_LINE+="      \"device\":"
JSON_CMD_LINE+="      {"
JSON_CMD_LINE+="        \"name\": \"sink\","
JSON_CMD_LINE+="        \"id\": \"4567\","
JSON_CMD_LINE+="        \"channel\": {"
JSON_CMD_LINE+="          \"name\": \"one_input\","
JSON_CMD_LINE+="          \"socket\": {"
JSON_CMD_LINE+="            \"name\": \"input1\","
JSON_CMD_LINE+="            \"type\": \"pull\","
JSON_CMD_LINE+="            \"method\": \"bind\","
JSON_CMD_LINE+="            \"address\": \"tcp://localhost:5571\","
JSON_CMD_LINE+="            \"sndBufSize\": \"1000\","
JSON_CMD_LINE+="            \"rcvBufSize\": \"1000\","
JSON_CMD_LINE+="            \"rateLogging\": \"1\" "
JSON_CMD_LINE+="          }"
JSON_CMD_LINE+="        }"
JSON_CMD_LINE+="      }"    
JSON_CMD_LINE+="  }"
JSON_CMD_LINE+="}"


RUN_TEST+=" --config-json-string $JSON_CMD_LINE"


@CMAKE_BINARY_DIR@/bin/$RUN_TEST
